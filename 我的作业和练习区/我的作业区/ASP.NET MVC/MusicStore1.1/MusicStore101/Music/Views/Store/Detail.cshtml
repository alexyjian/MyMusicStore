@model Music.ViewModels.DetailReply
@{
    ViewBag.Title = "专辑明细";
    Layout = "~/Views/Shared/_NewLayout.cshtml";
}

<div id="album-details">
    <div id="detail">
        <h2>@Model.Title</h2>
        <p>
            <img alt="@Model.Title" src="@Model.AlbumArtUrl" />
        </p>


        <p>
            <em>
                发布时间：
            </em>
            @Model.PublisherDate.ToString("yyyy年MM月dd日");
        </p>
        <p>
            <em>
                分类:
            </em>
            @Model.Genre.Name
        </p>
        <p>
            <em>
                歌手：
            </em>
            @Model.Artist.Name
        </p>
        <p>
            <em>
                价格：
            </em>
            ￥ @string.Format("{0:F}", (@Model.Price))
        </p>
        <div id="Music_div"><audio src="@Model.MusicUrl" controls="controls" id="audeo1"></audio></div>
        <div id="msg"></div>
        <p class="button">
            <a class="btn" id="addcart">添加到购物车</a>
            <div id="msg"></div>
        </p>

    </div>
    <div id="bg1">
        <span id="a"></span>
        <span id="b"></span>
        <div id="cd">
            <span id="cd_1"></span>
            <img src="@Model.AlbumArtUrl" id="cd_2" />
        </div>
        <span id="cd_bg"></span>
    </div>
    <h2>评论</h2>
    <div class="pinl_pinl">
        <div id="pinl_textarea">
            <script id="editor" type="text/plain" style="width:100%;height:75%;"></script>
        </div>
        <a href="#" id="pinl_bt" onclick="getContentTxt()">发表评论</a>
    </div>
    <h4 style="color:#5e5b54;margin-top: 30px"><em>全部评论</em></h4>
    <div class="pinl" id="album-details">
        @foreach (var p in Model.Replys)
        {    <div>
            <p>@p.Person.Name</p><p>@p.CreateDateTime</p>
                 @p.Content
             </div>
        }
    </div>
</div>


<!-- 配置文件 -->
<script src="~/UE/ueditor.config.js" type="text/javascript"></script>
<!-- 编辑器源码文件 -->
<script src="~/UE/ueditor.all.min.js" type="text/javascript"></script>
<!-- 实例化编辑器 -->
<script type="text/javascript">
    var ue = UE.getEditor('editor', { scaleEnabled: true });
    function getContentTxt() {
        var arr = [];
            arr.push(UE.getEditor('editor').getContent());
       
        alert(arr);
    }
</script>
<script>
    $("#addcart").click(function () {
        //异步
        $("#msg").html("<img src='../../content/images/loading.gif'/>添加到购物车，请稍候...");
        $.ajax({
            type: 'post',
            async: true,
            url: '../../ShoppingCart/AddCart',
            data: { id: "@Model.ID" },
            dataType: 'json',
            success: function (data) {
                //如果没有登录，跳转到登录页
                if (data == "nologin")
                    location.href = "@Url.Action("login","Account",new {returnUrl=Url.Action("Detail","Store",new {id=Model.ID})})";
                else {
                    //添加到购物车成功，把动画取消
                    $("#msg").html(data);
                    //重新刷新此区域
                    setTimeout(function () {
                        location.reload();
                    }, 1000);
                }
            }
        });
    });
    var time;
    var jis = 0;
    var ji = 0;
    var jj = 0;
    var myVideo = document.getElementById("audeo1");
    var a = document.getElementById("a");
    function CDip() {

        var cd = document.getElementById("cd");

        if (jj < 216) {
            jj++;
            a.style.transform = 'rotate(' + jj / 4 + 'deg' + ')';
        } else {
            ji++;
            cd.style.transform = 'rotate(' + ji / 4 + 'deg' + ')';
            myVideo.play();
        }
    }
    $("#bg1").click(function () {
        jis++;
        if (jis == 1) {
            time = setInterval(CDip, 1);

        }
        else {
            clearInterval(time);
            myVideo.pause();
            jj = 0;
            a.style.transform = 'rotate(0deg)';
            jis = 0;
        }

    });

    /*评论*/

   

</script>

